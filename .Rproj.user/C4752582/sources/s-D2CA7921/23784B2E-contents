---
title: "Notes 3/5/2020"
author: "Kaitlin"
date: "3/5/2020"
output: html_document
---

Load required packages:

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#install.packages("rtools")
#install.packages("here")
library(here)
library(tidyverse)
library(gapminder)
```

<!-- The following chunk allows errors when knitting -->

```{r allow errors, echo = FALSE}
knitr::opts_chunk$set(error = TRUE)
```

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Today is importing/exporting R files

## Writing Out
can write files out using 
write_typeoffile(which file to write, "Name of new file")

Now... lets start by filter gapminder to only Asia and 2007

```{r}
gap_asia_2007 <- gapminder %>%
   filter(year == 2007, continent == "Asia") %>% 
   print()
```


We can write this to a comma-separated value (csv) file with just one command:
```{r}
write_csv(gap_asia_2007, "exported_file.csv")
```

BUT theres a problem - where does the file save?
- should auto save to wherever you've opened R from
- called a "directory" - synonymous with "folder" in files 

2 to set this - 
1)getwd() - this is how you can find out what R's current working directory is - wherever this location is is where your written-out files will save to.

2)setwd() - DONT USE THIS ONE - only works with exact file & folder names, so likely wont work across devices

## 5 important things to remeber when writing scripts
1) Assume you're running in a fresh, clean R session AND make sure you actually are - include all of your library functions and make sure you're not using other files on your device because that won't work on someone elses device if they dont have the file or if its named differently.

2) Assume you have all of the needed packages and don't need to install anything. If you include install functions you'll be changing the other person's computer and we dont want to do that without explicit permission. -- try commenting out those lines or type "eval=false" into the {r} thing. so{r install, eval = FALSE}

3) Assume the script will run on its own - pre-import any data you're working with and load data/write output using R commands

4) Make sure all of the needed files live in your project folder - so you use RELATIVE paths rather than ABSOLUTE paths. That way you can send the whole project folder to your partner/client and they can use the codes because all paths are relevant to the files within the folder, instead of file and folder names on the device

5) Assume your script will be run on multiple systems - Windows, MAC, Linux, etc. - windows uses backslash, MAC & Linux use forward slash -- wrtie the files using file.path() or here::here()

## Rprojects
Click File → New Project… and then make a new project in your participation repo folder. Give it a useful name like DataSci-participation.Rproj.

When you double click on a .Rproj file, it: 1. Opens a new fresh R session, with 2. The working directory set to the location of the .Rproj file, and 3. No connection whatsoever to any other R sessions you already have open

You can also set specfic options for each RStudio project (e.g., number of spaces to insert when you type Tab, etc.).

When re-opening R.proj's, they'll remember what files you were working on last time you worked on the .proj and pull that up.

Let’s practice closing RStudio and re-opening it by opening the RStudio project. Run getwd() to see where R is running.

```{r}
getwd()
```

Yay! Now lets fine tune it even more. Lets say we're working on the plotting participation file - the getwd may change to "C:/Users/Kaitlin/Documents/GitHub/DataSci-Participation/Plotting"

to avoid this use here::here()

## here::here

You can make your projects very portable by using .Rproj RStudio projects and relative paths with file.path(). This still can be a little fiddly:
-Need to remember to open the .Rproj file, not a .Rmd or .R file
-If you open a .Rmd file contained in a subfolder, the working directory won’t be right for working with file.choose() for relative paths.

Enter the here package. here takes the idea of relative paths and extends it in very useful ways!

The major function is here::here(). Like file.path(), here::here() lets you specify a path to a file and then adds the system-appropriate separators (/ or \\). Where here::here() shines is that it figures out better where the relative paths should start from. It looks round in the folders in your directory and finds the .Rproj file, then constructs the relative file paths from there.

For example, create a new folder “data” in your participation repo, and within it make a subfolder called “s008_data”. Then, save gap_asia_2007 using the here::here() and write_csv() functions:

```{r}
write_csv(gap_asia_2007, here::here("data", "s008_data", "exported_file.csv"))
```



